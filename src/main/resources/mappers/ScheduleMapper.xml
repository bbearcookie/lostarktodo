<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lostarktodo.mapper.ScheduleMapper">
  <sql id="scheduleColumns">
    idx,
    name,
    period,
    resting_gauge,
    max_resting_gauge,
    complete_count,
    max_complete_count,
    type_idx,
    hero_idx,
    disabled
  </sql>
  
  <insert id="insertSchedule" parameterType="ScheduleDTO">
    INSERT INTO schedule (
      <include refid="scheduleColumns"/>
    ) VALUES (
      #{idx},
      #{name},
      #{period},
      #{restingGauge},
      #{maxRestingGauge},
      #{completeCount},
      #{maxCompleteCount},
      #{typeIdx},
      #{heroIdx},
      IFNULL(#{disabled}, 'N')
    )
  </insert>
  
  <update id="updateSchedule" parameterType="ScheduleDTO">
    UPDATE schedule
    SET
      name = #{name},
      resting_gauge = #{restingGauge},
      max_resting_gauge = #{maxRestingGauge},
      complete_count = #{completeCount},
      max_complete_count = #{maxCompleteCount},
      type_idx = #{typeIdx}
    WHERE
      idx = #{idx}
  </update>
  
  <select id="selectScheduleDetail" parameterType="int" resultType="ScheduleDTO">
    SELECT
      <include refid="scheduleColumns"/>
    FROM
      schedule
    WHERE
      idx = #{idx}
  </select>
  
  <update id="deleteSchedule" parameterType="int">
    UPDATE schedule
    SET
      disabled = 'Y'
    WHERE
      idx = #{idx}
  </update>
  
  <select id="selectDailyScheduleListByHeroidx" parameterType="int" resultType="ScheduleDTO">
    SELECT
      <include refid="scheduleColumns"/>
    FROM
      schedule
    WHERE
      hero_idx = #{heroIdx}
    AND
      period = 'D'
    AND
      disabled = 'N'
    ORDER BY
      idx
  </select>
  
  <select id="selectWeeklyScheduleListByHeroidx" parameterType="int" resultType="ScheduleDTO">
    SELECT
      <include refid="scheduleColumns"/>
    FROM
      schedule
    WHERE
      hero_idx = #{heroIdx}
    AND
      period = 'W'
    AND
      disabled = 'N'
    ORDER BY
      idx
  </select>
  
</mapper>